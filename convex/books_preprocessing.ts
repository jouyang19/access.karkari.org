import { mutation, query, action } from "./_generated/server";
import { api } from "./_generated/api";
import { ConvexError } from "convex/values";
import fetch from "node-fetch";

export const getAll = query({
  args: {},
  handler: async (ctx) => {
    return await ctx.db.query("books_preprocessing").collect();
  },
});

// List of storage IDs
const storageIds = [
  "kg25qmftbbxagdg7b5ydz91psh6xq0fz",
  "kg284qpnytkbhb888f8rqy7kcn6xpx8n",
  "kg21c93zc73h81s19axshn8d9d6xqbz6",
  "kg29exqngj9d856k8yta2yrs316xqrt9",
  "kg2746jjf72w54m4v8cp0pd5qn6xqjh9",
  "kg27h0grm9smqjh90rd8cfyw3h6xp2jm",
  "kg242hk5a47sfejrnax7ycme9d6xqavy",
  "kg23yfdx3g0ermt1x3t92ehjgh6xqyk9",
  "kg2eaxtyqzm312bjnd5qn49xkn6xpbzy",
  "kg288z4v2peqff77asnt4x01196xp4bz",
  "kg254awy9qp2nwxstb6asxpg5n6xpbw1",
  "kg22mrv96wtxd2v4pvthxxq3c56xqwpv",
  "kg23dnsyw6hpx825wt4hq1rsmn6xqe8d",
  "kg23908bnh3gh433e9p796abrn6xpwah",
  "kg27kjpareqbr8ca814d0mqfyn6xpevq",
  "kg27g219vgmherrpg5r7mxft296xqwqv",
  "kg2b3xb6p9tf17bqzk149857d16xqbw5",
  "kg27n54bqaf66bhde6yk77zb6n6xq5ty",
  "kg2c89vsers2w3r2101jja2mg96xphds",
  "kg2fb2wfdrcxpp02mj33mwkz1h6xqx15",
  "kg25z5qy01snsrhkcc476efqzs6xqasv",
  "kg271fqxfa6f11m50x6apa5b356xqqnh",
  "kg288s6h7c5r0rntf8jjyx3vph6xqn6n",
  "kg2c9t7hqg85qfsz88wb6pcmvd6xpzr1",
  "kg229dbmevnxydfr0ct6knx4sd6xpt33",
  "kg29s7kg9gnkdz9bjjg0120cm16xqbs2",
  "kg2ab18ktbsm9v8xg785an1yvs6xpbg3",
  "kg2dsadmtf35n1byh5d6vyg91h6xpnh3",
  "kg21r8rv04ct28h25tr4xsv2w96xpy37",
  "kg2dkzkeywkwpv8z9rps6g3bbh6xq5xn",
  "kg250fen67spv4bgec4syrejw56xqtvn",
  "kg251sfwpz8bk4sw76bbjvvdg96xqvjs",
  "kg20a7xxhwnr4wgvmhcvpr1rhh6xpkp1",
  "kg2edm7xm60960yjjmbttn24gn6xpynf",
  "kg260q2dzncjgn44aftprj3v9h6xqtqz",
  "kg2dkmebc12y52ey9g8hz68bb56xq92s",
  "kg28x5dv0jyhy87jz2001y5cjx6xpjst",
  "kg2cfqypbv6jrekme63p71fsbx6xq0d9",
  "kg2601dvaym8xyq1zgxzaj6qmx6xpghw",
  "kg2ac6y3h7dkywk3nhbzs1ha7h6xqbyg",
  "kg21t0gprp9hserhe8h6qt5xhx6xpw7w",
  "kg2bns0mxsbdb3hvrtv5z38kcx6xpfjf",
  "kg214zb8ymg40hda4x16rhvj656xqgkx",
  "kg2784ykzkch5jqg60emh0h3q96xqdz9",
  "kg2dwjfhvve4hjxyx5jbq51sad6xq4vq",
  "kg26myxkgsvcrx62bz1e9pptc96xpy9j",
  "kg2epj4fpg6z4n4rax7txc7atx6xqvp3",
  "kg2fs7fng20ts9qa76rnkc2cps6xq217",
  "kg25d58zv2s1sy8326x17rzmxs6xp5zg",
  "kg25ew71qv1xy0jz9dvah6fjed6xq639",
  "kg21ay88pk54fy7f24r5kc42ns6xq15r",
  "kg29ww4nwby8njmznwgj0bx0cd6xpqnd",
  "kg287fjbs2eq77e6nsvtn5jc2h6xpn5h",
  "kg2dmx1an709834nj0d2hnth756xp4aq",
  "kg2c022hjr2bvgmxjzjtvrm9fn6xqa5b",
  "kg23qb4wfdtg18qww932gq641n6xpnpn",
  "kg22ebzn0ghqcftat4cefyqex96xqpsm",
  "kg2e2cn6wqc5wpa4rm741cgrfs6xq56a",
  "kg2e6pnssm9z3y961mjafbbnk96xpgje",
  "kg258epe9ypy7arp9b07negkws6xqyzv",
  "kg2fg20fmz536qp222qx3ykw3d6xqf3f",
  "kg2d6mrq54gscgepr2mx6ahxgx6xp9gf",
  "kg2d07b7spa1n42pvs9s7vm4wn6xq61f",
  "kg2bgyxyg0x0f50tg9pakqh62x6xqphe",
  "kg24atrnb8507bch5c9nnbywyh6xpj92",
  "kg2fpd4k1bj39sb7mdx44k8fxd6xq7qe",
  "kg2523x9knq8m76n0yrdv4xrq96xqw57",
  "kg25hc13mtwv36nwj1ph13p7bh6xp5wh",
  "kg23bcba2898b16prxr6jprfv96xqzx2",
  "kg27caj86dyqxys8m6t53rvkb56xpnna",
  "kg28tg67yf1e574m8zh471r8tx6xqxem",
  "kg23pzsmv5h7fr3a2ekpv275wn6xpaw0",
  "kg2e31wfcj3w1q90dfj0tk2n2x6xpyyx",
  "kg2fdrmd3d9swaxsw0rt80smf16xq0dq",
  "kg2b328y5akht7sgq1dhmvqmnx6xq6v3",
  "kg270ek4gwte8wf4zst6b5xxbd6xpm46",
  "kg2f6t58354bg52hax1zgb675h6xqyhg",
  "kg2f2d7cv1fd92d5fja7zbe0bx6xpv5w",
  "kg2agxz5vkpemm2e5vn69082q16xqmxv",
  "kg273p5k1y992rkd3aexg1vf316xqrg4",
  "kg29pydypcq0ar4gxb6554e6796xp2cd",
  "kg25gqh2kmkw6hnyskpxxxqcp96xpnpa",
  "kg2fvvgtf1dng1xb0shms2jc6n6xptkt",
  "kg2chhswa7mvfyqsrt0kpvcdsn6xqg32",
  "kg2cfvjfb2pq67m3r0teacgn5x6xpd2p",
  "kg2e36z2902te8yrdh7tb5apz96xpppf",
  "kg2fhhtta1s30zekntbhxbdjd56xpkhm",
  "kg2a4yf26s0rp056vvws0y8p8x6xqam6",
  "kg24728fn0rkz5118ztvhfs2bd6xq863",
  "kg2eyw4nbghjsvpg68czbmc0k96xpm07",
  "kg25n3theakarn4neshjw95bnn6xpckv",
  "kg2afcjqqm84vtqyd61qczx7r96xqh09",
  "kg28x7sfxn52k28pcv2hsh413d6xqjhw",
  "kg24pe0wx9n3c97gy55x59rkqn6xq2kw",
  "kg2f9tsbmrvxg3qdh4ttnbfk5d6xqdd0",
  "kg229y3hkxc6xk5pgbmn11e2b56xq5zd",
  "kg20sxvyf902pdxq3axp2gxkv56xp8a7",
  "kg2fwvd99fpd9s1r0dfptznnnh6xqcct",
  "kg285r2g7v8zvd22qy4csexyhh6xq51q",
  "kg2cspknf97khhnyt9vjbgvn2x6xp9fc",
  "kg2fh0mv87vgsqyv2afy87r1f56xp2b2",
  "kg2ddjvng20prjpy1j3sv4qpx16xp4v7",
  "kg29sdcvvvwv09qfmtbt9pg9n56xqfbn",
  "kg23vs061g6g0492p1fqqqmyt16xp4by",
  "kg2br6jws62sg5k8txmxtqxx4n6xqf3z",
  "kg21ecy66q6sspad8f20jrqv616xpe9j",
  "kg2ck5s4bgzqx6s8m70y00pbrh6xqyx3",
  "kg270ew734c5hqyr3rv269xrzs6xq3pw",
  "kg25s06rtthkqhjggez0jyqdt16xqhty",
  "kg2bph02cvn4kzmw5d84zcs7wh6xq12k",
  "kg220n3c4hg14j640t09yx20956xpv6w",
  "kg21dntxn0d9tjjz2q53rd308h6xp3b0",
  "kg23h6m9gamv1f5nphswrvgx1d6xqy68",
  "kg27r43z13f1hwxw33xa5pabcs6xqfj2",
  "kg2dbqhmsffatpgb669d4wkaw56xqf6z",
  "kg218qnxzzkv8ygewr8erjkq016xqf04",
  "kg29nw6dqjyd6dhxz8tdgvdfjh6xq4sa",
  "kg2abaf9qw7g64r3253m6fsx256xp3km",
  "kg2fx8tba4xa9twt64qsc2gtj56xp4tk",
  "kg29k6k13g99j9s0d6yrtt4c6x6xpj5g",
  "kg2ebe4sd8v2277vy4jdqx0f5d6xqx4e",
  "kg2b3v2h256me6q7ems80s62x96xq4vc",
  "kg2czctg419pgmr6mmrspera9n6xqma5",
  "kg23c3554zgztkccydyn6bqfcx6xqn7b",
  "kg2bmcphf6cb5zr0f1t74yzs7d6xpn12",
  "kg20wnsvrpz12nh965nacbqexx6xqhrj",
  "kg2a9fyz73r216nfk4rengtte16xqprj",
  "kg2axy098n76gbyeg4m02wfjcd6xqqwr",
  "kg24z7j04xsaktaksbcb1scwvd6xp8eg",
  "kg2f3d5jn5ztd215dvkj8gm44n6xqznk",
  "kg21z0kqfjk8rzxw087a9tj5xd6xq5rw",
  "kg25agrbs8vmq3v8wp8gzswvmn6xpphc",
  "kg2e89609jm4bdsrj515xaxtf96xqj4n",
  "kg25x6wxhwj2dpq2bbd2badqyh6xq87g",
  "kg291vkvs9esaf3hswca1vmj7d6xpv1j",
  "kg23dk29bymd0qx0nc3nqe1k0d6xqs0m",
  "kg22fq4sc45s8w3dfs4h7f9zws6xqz95",
  "kg2fq1vn3jbcnwtba31nqnwvqx6xp666",
  "kg271zp5btgsekpj3bp24hnn216xqs08",
  "kg2d52w835y21vzrae5z4fmq4s6xp57y",
  "kg2b8h7hr8n1gs9wx3mkqf308d6xqgfs",
  "kg239hzgwz75a927ajcevjwqy96xpn9a",
  "kg23gewxs0z1t7xx3b6sm4pma56xq3ra",
  "kg28wzs7gj9wxfsyfv0e3nhxk16xqa4t",
  "kg263m498081z0s3rvx0g3qeyh6xpksd",
  "kg2cjbj4s98ab0mxw2y4g9scb96xpwnj",
  "kg2c4k2t7kzjphg64dswqyh3ex6xqnye",
  "kg2af7jw6evh144m1s6kg45ga16xpaqn",
  "kg243gk4pf4sf9c0xx67mvh5z96xqacs",
  "kg285wzgzdv8hkc0tf6ng989f56xp4jt",
  "kg2d5y3r52k8017066rtg25nfd6xqzqx",
  "kg24rez6yz94f26992grtg82qh6xp2y1",
  "kg24zn79dmf8pf5w0bd869h9fh6xp34q",
  "kg2fhptma42bg0hdckd3qp75ws6xphvj",
  "kg26djb88e9mzz2sjdyx3swhnd6xqqf2",
  "kg22v6xkg37qfhrfghpvg6xbjd6xqran",
  "kg2d144kngecrkxeszdj7x8sf16xq7rb",
  "kg2bcghdnrc2mp23tdt08afrqn6xq8dm",
  "kg2dxeyrdc4bzxq5phn365yb1x6xq247",
  "kg2857xgtccfkzeza7jxwk1gdh6xpnc4",
  "kg2dvm0n9k9pzyejxe9j3v0zzh6xq2d7",
  "kg20d65b3h6gx8397gw9ta2xr16xqsvr",
  "kg22bt0kx0607yxxhre6z5rkd16xqgpm",
  "kg2dshjt8emqwxbh3twxtswdrd6xpzzc",
  "kg2bby6snppgxzbhn0g3jm15m56xpesy",
  "kg2af3wngrydwxq2c73dpc351n6xpbwx",
  "kg2b16vx88e2qgdb3kaksc3wz56xqnrj",
  "kg24h9mt3h86ff4bkrvx3ykgbx6xqpa1",
  "kg2evqcpmp93kxrf4nzkxvnq3n6xpgkf",
  "kg2b245bzb0mdw7ft6yb00yap56xqkx8",
  "kg205b0ace2xxw41f5fxqmqghx6xqesh",
  "kg2fkzygs4v7qsqjhz6q0j5bc16xp0fx",
  "kg2ar4d2nj53x9hsvfhy968zjx6xptta",
  "kg25r44gv8bt5d0rym0646b8516xp8y6",
  "kg21gkjx634n4h5zqs6weyf1zn6xp0h7",
  "kg2a5bvzefv1w0w2a56e18aheh6xq1zy",
  "kg230xjpft55n92xh0tgjdr7116xpcz8",
  "kg2ahkwe976xs6djd2hghv1zc16xqa5m",
  "kg2cvhqqbxxr2nz81923nsxe1h6xp59m",
  "kg2amghk0ygtf8kbmsprbf0br16xprm5",
  "kg21ba8te0k35nbn61k8gkbrrd6xpp45",
  "kg2bdnhbhhr8g2sp83thqsn1ah6xpvyg",
  "kg2ab3tss76qm7ebna8ryskzyd6xqvr8",
  "kg2e798gb2y5c606fk5gwhhcdx6xp7n8",
  "kg28p16s3febp7p8xp9ma0kej96xq3za",
  "kg25zp9znbcwg1x4s3ta7sy46h6xpws7",
  "kg2datw5f32cf17348wmahp6vh6xpzyb",
  "kg2e4gvhn057qe8h8dwh17d4956xqatb",
  "kg24vygcp1f7p01gxbczdshjxx6xq51p",
  "kg2atq066bn7bgbgda8359hqc56xp0z5",
  "kg27ppx32r3cpqsn6c1611f20x6xqfve",
  "kg24eh16fqtn18t858fjawqcms6xq61z",
  "kg282gjh1nsrxmnr88yxgk38a56xqm5t",
  "kg23yb4kj1y58pyyr0s8g52w596xpwsq",
  "kg28g3q4q00fk6k22xya4q1kms6xppbe",
  "kg2b12aj75jhwh0xxhystdcv5n6xpwt1",
  "kg2fhtme86yz5zksy5asxxa3vs6xq6b5",
  "kg22phne3y2xpp2ncnap416rfs6xq2as",
  "kg272d6nh0cg5hc4qgpkjgq0jx6xp2fk",
  "kg26rpd5cgxps3j343cj9mqm2d6xp17v",
  "kg23xm14gyd0rxd1cqdsb08dps6xpng9",
  "kg2b7j3066hazg64y8tc94hf9x6xq8ze",
  "kg24xqj37w2farvjfz1ybh8tr16xp2hk",
  "kg25qng8h6kz2h0qbwp97f5n5n6xpecv",
  "kg2az8sr5zdm35f8fezy8vh0ws6xqb3b",
  "kg28y1enh29y1n7f50h76w02216xpbqn",
  "kg22wjt0s4brzhqzf2ap6jmmps6xqed0",
  "kg2bgq2b6x4dja93emarrkt4896xqdq6",
  "kg28yn5t5n8mstr9vbjcevk1796xqccz",
  "kg29mkv9v3gj5f6t9s92a831j96xprrj",
  "kg2cxh5wgz0m76ga79mnbjk5m16xp34e",
  "kg2e109bp2bbqbdjf7b2w4yrf56xq5bz",
  "kg271618s52p3gef9sfeyw6g8h6xp5ge",
  "kg27d3f6wk6yza7s33varkc6rn6xph0r",
  "kg25gwb8aw7wr96zap4fpjncn16xq97y",
  "kg2bnxt228w6rg3xnwkwfjg2p56xpj5s",
  "kg28wt2b70bwcztb9gxz94yyfx6xpmtk",
  "kg24evj31mazhykx00bchv5v616xp1gn",
  "kg2dgcc0vzgz0g1hct7k842xbd6xprwy",
  "kg2ahbav31fj28dvy56vy7bn3d6xq5gn",
  "kg2dswsyvnpfpk388wdj2ewxp16xqp1a",
  "kg20y45w4d7ykn8eqec88asmwx6xqzmv",
  "kg2e7q6hb5f1spbs7zmazxswz16xpzh4",
  "kg22aft2artcqabtqwsyc6m1996xq8yy",
  "kg2cdrmsx8jsxmhzbdsd001sx16xq1fj",
  "kg22n3baz63nwqs3vqfzd01ceh6xp6x5",
  "kg26rb41ddxm5mqz0kn0r64k816xqfws",
  "kg2aj3serjbwhdg2b1kgn1ywss6xq0xy",
  "kg2exj0zj2r17fhrv0vpgkmpz56xpeht",
  "kg24crb9cch0h505zsxy29rdxn6xpydv",
  "kg24efgfm3th63nar8bq8y17b56xp0fg",
  "kg2c415v8sev6jrn9hs134mscd6xpq6r",
  "kg2fsxxvz5syd9bercj8k587996xpccc",
  "kg297mnanbsjwf91gd3enakqq56xq3ex",
  "kg2bra7ywrvq4p8xnkkegk6sgs6xqn70",
  "kg2f1a5hyqnzz4qfhhrr7633016xqv69",
  "kg28a34fzftmvdxn5wffp8df956xqwqw",
  "kg2dtnmvqqk4c39ctv9cdh1zd16xq4cg",
  "kg24eg1njvt5gj6d5rxr2j417h6xptpn",
  "kg2aw5c3q64retfnecr0s1vd2n6xqv8h",
  "kg2fam0brb07derj7bg50z9afx6xpvcd",
  "kg2dqk459b2s4ajdrp4pv3gnjn6xqzw6",
  "kg2940bk39kd8hztqndp0jpeax6xpjj4",
  "kg2785b9xzk8j382x8bb2pr7qh6xqxkk",
  "kg210h4qn0v5ar93km9k9qy1sh6xqegk",
  "kg23k6ryppc3n7yzs4yz1hxn2x6xpj35",
  "kg2b0nz1jt96c7aszhb9awj5v96xpb67",
  "kg21mcdyw7xytnmdd8e6sa1yx96xpfyz",
  "kg263f7g6h8sqb5dpz6xaenv1x6xqatq",
  "kg209n2m4c8hm0b13cs9ekp6gh6xp803",
  "kg2afyr9tr345j3266yg91ykeh6xpyx8",
  "kg25h2be0g3zc7jvjznw2vkxc96xp8d0",
  "kg24q2skg5qwncf62h6b2yw1ax6xq1g9",
  "kg23sp3nts04c17xyhf5q2fq6x6xp4qe",
  "kg2f2e00bmske1ydejk0bd1t696xqjt8",
  "kg27bnf77gt632drtg5ycgay0x6xpxnt",
  "kg25vstg976fe62g4j0m6bvj0d6xpq01",
  "kg2efkdtqtdkrp6g5a84rz4tcx6xpxmz",
  "kg2839cy73a0x1bdyrhk9a8bq56xpmqt",
  "kg22thc1aje0w47qw61hymerd56xqncy",
  "kg251qmfj10ap30cfjtvr1e89x6xp8bk",
  "kg20rz5j73fgw1a3dga98swfc56xqpna",
  "kg267z0jtx8fnh34t3bz6c8cpn6xp3md",
  "kg244s04zhazf9x7q581v5032n6xqpm4",
  "kg24p6xb1qjd3c2g29tn86gym96xpm7f",
  "kg2ccrcw05xd5nqa1qa74rwejh6xpw3c",
  "kg25gthcx36pgfdm98bkt125yn6xq867",
  "kg217khgcyhrg9z9np0z9xdskx6xqthj",
  "kg2601v68kqbxb213nqyjbaz616xq8y9",
  "kg2fpehzztc0gkvrq5jgqspssh6xpnfr",
  "kg253mjra8sfh15pa8fsv647516xpkht",
  "kg2azx2na1r1gyp7s9jbch9j756xpvea",
  "kg21r8bxrteahhgmc3x53j5fa96xqpmj",
  "kg2afjcwek3zf6kjh1t4fx2rjn6xpdj4",
  "kg2faaxt6hq9taxfx386s9sseh6xpcrd",
  "kg2956jab7875nmbwy8x4h23p96xqfey",
  "kg20nnh2kgfg5wqh9wc27nt02h6xp7vv",
  "kg2fgs15hexfkecm2z0yr7ee7n6xqg02",
  "kg2513cf67e1gn969wdsq0fhbd6xq9km",
  "kg24deane99ss3shhgaet7wnrn6xpgzq",
  "kg2c4bpa5rkgqmpq7b9w20s33h6xq6zz",
  "kg21nrnhbekkzfmqqhvd57hcnh6xq1fg",
  "kg26x2p7rjmm1k254hnfdsp8ds6xqsa0",
  "kg266yf6brp7szh3vxbqf7qhzh6xqtee",
  "kg2cc1wmvsxkawm2083v4yyh3x6xqmay",
  "kg27yfg9eq5m55x8248j4j28s56xqv48",
  "kg2ew76z9jqpnx298yq7hartq96xpfyn",
  "kg20bcgbad02xee49487psppyx6xqksd",
  "kg27mr9d4a6jbhk81m4zan2gs56xpjkb",
  "kg2bp5kg9vx56xc1bvts0sr95s6xp6ys",
];

export const generateFileUrls = mutation({
  args: {},
  handler: async (ctx) => {
    const results = [];

    for (const storageId of storageIds) {
      // Generate the file URL
      const fileUrl = await ctx.storage.getUrl(storageId);

      // Store the file URL in the books_preprocessing table
      const documentId = await ctx.db.insert("books_preprocessing", {
        storageId,
        fileUrl,
      });

      results.push({ storageId, fileUrl, documentId });
    }

    return results;
  },
});
